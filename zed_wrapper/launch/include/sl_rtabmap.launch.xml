<!-- RTAB-Map launcher -->

<launch>

    <!-- RGB-D related topics -->
    <arg name="rgb_topic"               default="/zed_node/rgb/image_rect_color" />
    <arg name="depth_topic"             default="/zed_node/depth/depth_registered" />
    <arg name="camera_info_topic"       default="/zed_node/rgb/camera_info" />
    <arg name="depth_camera_info_topic" default="/zed_node/depth/camera_info" />

    <arg name="odom_topic"              default="/zed_node/odom" />    <!-- Odometry topic name -->
    
    <node pkg="nodelet" type="nodelet" name="pcl_manager" args="manager" output="screen" />

    <!-- Run a VoxelGrid filter to clean NaNs and downsample the data -->
    <node pkg="nodelet" type="nodelet" name="voxel_grid" args="load pcl/VoxelGrid pcl_manager" output="screen">
        <remap from="~input" to="/zed_node/point_cloud/cloud_registered" />
        <rosparam>
        filter_field_name: z
        filter_limit_min: -3
        filter_limit_max: 10
        filter_limit_negative: False
        leaf_size: 0.02
        </rosparam>
    </node>

    <!-- <node pkg="nodelet" type="nodelet" name="obstacles_detection" args="load rtabmap_ros/obstacles_detection stereo_nodelet"--> 
    <node pkg="nodelet" type="nodelet" name="obstacles_detection" args="standalone rtabmap_ros/obstacles_detection">
      <remap from="cloud" to="/voxel_grid/output"/>
      <remap from="obstacles" to="/planner_cloud"/>

      <param name="frame_id" type="string" value="zed_base_link"/>
      <!-- <param name="map_frame_id" type="string" value="map"/> -->
      <param name="Grid/MinClusterSize" type="int" value="50"/>
      <param name="Grid/MaxObstacleHeight" type="double" value="0.0"/>
   </node>



</launch>

